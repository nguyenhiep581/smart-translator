<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Translator Settings</title>
    <link rel="stylesheet" href="options.css" />
  </head>
  <body>
    <div class="options-container">
      <aside class="sidebar">
        <div class="sidebar-header">
          <h1 class="app-name">Smart Translator</h1>
          <div class="app-version" aria-label="Extension version"></div>
        </div>

        <nav class="sidebar-nav">
          <button class="nav-item active" data-section="provider">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path d="M13 10V3L4 14h7v7l9-11h-7z" stroke="currentColor" stroke-width="2" />
            </svg>
            Provider Settings
          </button>
          <button class="nav-item" data-section="websearch">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="2" y1="12" x2="22" y2="12"></line>
              <path
                d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
              ></path>
            </svg>
            Web Search
          </button>
          <button class="nav-item" data-section="language">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"
                stroke="currentColor"
                stroke-width="2"
              />
            </svg>
            Language
          </button>
          <button class="nav-item" data-section="cache">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"
                stroke="currentColor"
                stroke-width="2"
              />
            </svg>
            Cache
          </button>
          <button class="nav-item" data-section="backup">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M12 5v9m0 0l-3-3m3 3l3-3M5 19h14"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            Backup
          </button>
          <button class="nav-item" data-section="about">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                stroke="currentColor"
                stroke-width="2"
              />
            </svg>
            About
          </button>
        </nav>
      </aside>

      <main class="main-content">
        <!-- Provider Settings Section -->
        <section class="section active" id="provider-section">
          <div class="section-header">
            <h2 class="section-title">Provider Settings</h2>
            <button id="save-provider" class="btn btn-primary">Save Settings</button>
          </div>

          <div class="card">
            <h3 class="card-title">Select AI Provider</h3>
            <div class="form-group">
              <label class="form-label" for="provider-select">Provider</label>
              <select id="provider-select" class="form-select">
                <option value="openai">OpenAI</option>
                <option value="claude">Claude</option>
                <option value="gemini">Gemini</option>
              </select>
            </div>
          </div>

          <div class="card" id="openai-config" style="display: none">
            <h3 class="card-title">OpenAI Configuration</h3>
            <div class="form-group">
              <label class="form-label">API Host (Optional)</label>
              <input
                type="url"
                id="openai-host"
                class="form-input"
                placeholder="https://api.openai.com"
              />
              <div class="form-help">For custom OpenAI-compatible APIs (Azure, LocalAI, etc.)</div>
            </div>
            <div class="form-group">
              <label class="form-label">API Path (Optional)</label>
              <input
                type="text"
                id="openai-path"
                class="form-input"
                placeholder="/v1/chat/completions"
              />
              <div class="form-help">Leave empty to use default path</div>
            </div>
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input type="password" id="openai-api-key" class="form-input" placeholder="sk-..." />
            </div>
            <div class="form-group">
              <label class="form-label">Model</label>
              <select id="openai-model" class="form-select">
                <option value="gpt-5-mini">GPT-5 Mini</option>
                <option value="gpt-4-turbo-preview">GPT-4 Turbo</option>
                <option value="gpt-4">GPT-4</option>
                <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
              </select>
            </div>
            <div class="form-group">
              <button id="openai-get-models" class="btn btn-secondary btn-sm">
                Get Available Models
              </button>
            </div>
            <div class="form-group">
              <button id="openai-test-connection" class="btn btn-ghost btn-sm">
                Test Connection
              </button>
            </div>
          </div>

          <div class="card" id="claude-config" style="display: none">
            <h3 class="card-title">Claude Configuration</h3>
            <div class="form-group">
              <label class="form-label">API Host (Optional)</label>
              <input
                type="url"
                id="claude-host"
                class="form-input"
                placeholder="https://api.anthropic.com"
              />
              <div class="form-help">For custom Claude-compatible APIs</div>
            </div>
            <div class="form-group">
              <label class="form-label">API Path (Optional)</label>
              <input type="text" id="claude-path" class="form-input" placeholder="/v1/messages" />
              <div class="form-help">Leave empty to use default path</div>
            </div>
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input
                type="password"
                id="claude-api-key"
                class="form-input"
                placeholder="sk-ant-..."
              />
            </div>
            <div class="form-group">
              <label class="form-label">Model</label>
              <select id="claude-model" class="form-select">
                <option value="claude-sonnet-4-5">Claude Sonnet 4.5</option>
                <option value="claude-haiku-3-5">Claude Haiku 3.5</option>
              </select>
            </div>
            <div class="form-group">
              <button id="claude-get-models" class="btn btn-secondary btn-sm">
                Get Available Models
              </button>
            </div>
            <div class="form-group">
              <button id="claude-test-connection" class="btn btn-ghost btn-sm">
                Test Connection
              </button>
            </div>
          </div>

          <div class="card" id="gemini-config" style="display: none">
            <h3 class="card-title">Gemini Configuration</h3>
            <div class="form-group">
              <label class="form-label">API Key</label>
              <input type="password" id="gemini-api-key" class="form-input" placeholder="AIza..." />
              <div class="form-help">
                Get your API key from
                <a href="https://aistudio.google.com/apikey" target="_blank">Google AI Studio</a>
              </div>
            </div>
            <div class="form-group">
              <label class="form-label">Model</label>
              <select id="gemini-model" class="form-select">
                <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash Exp</option>
                <option value="gemini-1.5-pro-latest">Gemini 1.5 Pro Latest</option>
                <option value="gemini-1.5-flash-latest">Gemini 1.5 Flash Latest</option>
                <option value="gemini-1.5-pro">Gemini 1.5 Pro</option>
                <option value="gemini-1.5-flash">Gemini 1.5 Flash</option>
              </select>
            </div>
            <div class="form-group">
              <button id="gemini-get-models" class="btn btn-secondary btn-sm">
                Get Available Models
              </button>
            </div>
            <div class="form-group">
              <button id="gemini-test-connection" class="btn btn-ghost btn-sm">
                Test Connection
              </button>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">System Prompt</h3>
            <div class="form-group">
              <label class="form-label">Custom Instructions (Optional)</label>
              <textarea
                id="system-prompt"
                class="form-textarea"
                rows="4"
                placeholder="You are a professional translator..."
              ></textarea>
              <div class="form-help">Leave empty to use default prompt</div>
            </div>
          </div>
        </section>

        <!-- Web Search Settings Section -->
        <section class="section" id="websearch-section" style="display: none">
          <div class="section-header">
            <h2 class="section-title">Web Search Settings</h2>
            <button id="save-websearch" class="btn btn-primary">Save Settings</button>
          </div>

          <div class="card">
            <h3 class="card-title">Search Configuration</h3>
            <div class="form-group">
              <label class="form-label">Search Provider</label>
              <select id="search-provider" class="form-select">
                <option value="ddg" selected>DuckDuckGo (Free)</option>
              </select>
            </div>

            <div id="ddg-search-config">
              <h4
                class="card-subtitle"
                style="margin-top: 16px; margin-bottom: 8px; font-size: 14px"
              >
                DuckDuckGo Settings
              </h4>
              <p class="info-text">
                DuckDuckGo search is free and requires no API key.
                <br />
                <span style="font-size: 12px; color: #666"
                  >Note: This uses HTML scraping and may be less reliable.</span
                >
              </p>
            </div>
          </div>
        </section>

        <!-- Language Section -->
        <section class="section" id="language-section" style="display: none">
          <div class="section-header">
            <h2 class="section-title">Language Settings</h2>
            <button id="save-language" class="btn btn-primary">Save Settings</button>
          </div>

          <div class="card">
            <h3 class="card-title">Default Target Language</h3>
            <div class="form-group">
              <select id="default-target" class="form-select">
                <!-- Options will be populated by JavaScript -->
              </select>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Translation Shortcuts</h3>
            <div class="form-group">
              <label class="form-checkbox">
                <input type="checkbox" id="enable-ctrl-shortcut" />
                <span>Enable Ctrl/Cmd shortcut</span>
              </label>
              <div class="form-help">
                Press Ctrl (or Cmd on Mac) after selecting text to instantly show translation popup
              </div>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Supported Languages</h3>
            <div class="info-box">
              <p>This extension supports the following target languages:</p>
              <ul class="lang-list" id="supported-languages">
                <!-- Languages will be populated by JavaScript -->
              </ul>
              <p class="info-note">Source language detection is automatic</p>
            </div>
          </div>
        </section>

        <!-- Cache Section -->
        <section class="section" id="cache-section" style="display: none">
          <div class="section-header">
            <h2 class="section-title">Cache Settings</h2>
            <button id="save-cache" class="btn btn-primary">Save Settings</button>
          </div>

          <div class="card">
            <h3 class="card-title">Memory Cache</h3>
            <div class="form-group">
              <label class="form-label">Max Entries</label>
              <input
                type="number"
                id="cache-max-entries"
                class="form-input"
                value="500"
                min="100"
                max="2000"
              />
              <div class="form-help">Maximum translations to keep in memory</div>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Persistent Cache</h3>
            <div class="form-group">
              <label class="form-label">TTL (Time to Live)</label>
              <div class="input-group">
                <input type="number" id="cache-ttl" class="form-input" value="7" min="1" max="90" />
                <span class="input-suffix">days</span>
              </div>
              <div class="form-help">How long to store translations</div>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Cache Statistics</h3>
            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-value" id="cache-memory-count">-</div>
                <div class="stat-label">Memory Cache</div>
                <div class="stat-subtext" id="cache-memory-meta">Max: -</div>
              </div>
              <div class="stat-card">
                <div class="stat-value" id="cache-persistent-count">-</div>
                <div class="stat-label">Persistent Cache</div>
                <div class="stat-subtext" id="cache-persistent-meta">Size: -</div>
              </div>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Cache Actions</h3>
            <div class="form-group">
              <button id="clear-cache" class="btn btn-secondary">Clear All Cache</button>
              <div class="form-help">Remove all cached translations</div>
            </div>
          </div>
        </section>

        <!-- Backup Section -->
        <section class="section" id="backup-section" style="display: none">
          <div class="section-header">
            <h2 class="section-title">Backup & Restore</h2>
          </div>

          <div class="card">
            <h3 class="card-title">Export Settings & Prompts</h3>
            <div class="form-group">
              <label class="form-checkbox">
                <input type="checkbox" id="export-include-secrets" />
                <span>Include API keys (requires trust in destination)</span>
              </label>
              <div class="form-help">
                Exports configuration, prompt library, and system prompt to a versioned JSON file.
                API keys are excluded unless explicitly included.
              </div>
            </div>
            <div class="form-group">
              <button id="export-config" class="btn btn-primary">Export JSON</button>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Import Settings & Prompts</h3>
            <div class="form-group">
              <label class="form-checkbox">
                <input type="checkbox" id="import-allow-secrets" />
                <span>Allow API keys from file to overwrite current keys</span>
              </label>
              <div class="form-help">
                Only import files you trust. Keys are skipped unless you allow them here.
              </div>
            </div>
            <div class="form-group">
              <input type="file" id="import-file-input" accept="application/json" hidden />
              <button id="import-config" class="btn btn-secondary">Import JSON</button>
            </div>
          </div>
        </section>

        <!-- About Section -->
        <section class="section" id="about-section" style="display: none">
          <div class="section-header">
            <h2 class="section-title">About</h2>
            <button id="save-about" class="btn btn-primary">Save Settings</button>
          </div>

          <div class="card">
            <h3 class="card-title">Smart Translator</h3>
            <div class="about-content">
              <p><strong>Version:</strong> 1.0.7</p>
              <p><strong>Author:</strong> nguyenhiep</p>
              <p>
                <strong>Description:</strong> AI-powered translation extension with multi-provider
                support plus screenshot OCR ‚Üí translate.
              </p>
              <p>
                <strong>Supported Providers:</strong> OpenAI, Claude (with custom endpoint support)
              </p>
              <p><strong>Target Languages:</strong> English, Japanese, Vietnamese, Chinese</p>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Developer Settings</h3>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" id="debug-mode" />
                <span>Enable Debug Mode</span>
              </label>
              <div class="form-help">Show detailed logs in browser console (requires reload)</div>
            </div>
          </div>

          <div class="card">
            <h3 class="card-title">Features</h3>
            <ul class="feature-list">
              <li>‚ú® Select text to translate instantly</li>
              <li>üîÑ Two-layer caching system</li>
              <li>üåê Automatic language detection</li>
              <li>‚ö° Floating icon for quick access</li>
              <li>üìù Mini popup and expand mode</li>
              <li>üìä Usage analytics</li>
            </ul>
          </div>
        </section>
      </main>
    </div>

    <script src="options.js" type="module"></script>
  </body>
</html>
